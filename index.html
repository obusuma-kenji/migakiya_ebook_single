
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ã€ä¼šç¤¾ã®ç£¨ãå±‹ã€â€” eBook (single-file)</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --ink: #1f2937;
    --paperA: #fff;
    --paperB: #f8fafc;
    --ui: rgba(255,255,255,0.8);
  }
  [data-theme="sepia"]{
    --ink: #3c2f2f;
    --paperA: #fff4e6;
    --paperB: #ffefe0;
    --ui: rgba(255,245,230,0.9);
  }
  [data-theme="dark"]{
    --ink: #e5e7eb;
    --paperA: #0f1115;
    --paperB: #121520;
    --ui: rgba(17,24,39,0.7);
  }
  *{ box-sizing:border-box; }
  body{
    margin:0; background: linear-gradient(135deg,var(--paperA),var(--paperB));
    color: var(--ink); font-family: 'Noto Sans JP', system-ui, -apple-system, Segoe UI, Roboto, 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', 'Yu Gothic UI', 'YuGothic', Meiryo, sans-serif;
  }
  .noise{position:fixed;inset:0;pointer-events:none;opacity:.05;mix-blend:overlay;background-image:radial-gradient(currentColor 1px,transparent 1px);background-size:12px 12px}
  header{position:sticky;top:0;z-index:10;backdrop-filter:blur(8px);background:var(--ui);border-bottom:1px solid rgba(255,255,255,.2)}
  header .bar{max-width:1100px;margin:0 auto;padding:10px 14px;display:flex;gap:8px;align-items:center}
  header .title{font-weight:700;letter-spacing:.02em}
  header .spacer{flex:1}
  button,select,input[type=range]{
    color:inherit;background:transparent;border:1px solid rgba(255,255,255,.2);
    padding:6px 10px;border-radius:10px;cursor:pointer
  }
  button:hover{background:rgba(255,255,255,.1)}
  .grid{max-width:1100px;margin:0 auto;padding:18px 14px;display:grid;grid-template-columns:1fr;gap:16px}
  @media (min-width:960px){ .grid.toc-open{grid-template-columns:280px 1fr} }
  aside{background:var(--ui);border:1px solid rgba(255,255,255,.2);border-radius:16px;padding:12px;max-height:72vh;overflow:auto}
  .viewer{background:var(--ui);border:1px solid rgba(255,255,255,.2);border-radius:16px;padding:16px;box-shadow:0 10px 40px rgba(0,0,0,.1);height:72vh;overflow:hidden;position:relative}
  .pages{height:100%;display:grid;gap:16px}
  .pages.spread{grid-template-columns:1fr 1fr}
  .page{height:100%;border-radius:12px;background:linear-gradient(to bottom right,#fff, #fff);color:#111;overflow:auto;border:1px solid rgba(0,0,0,.05)}
  [data-theme="dark"] .page{background:linear-gradient(to bottom right,#0b0e14,#12151d);color:#e5e7eb;border-color:#000}
  [data-theme="sepia"] .page{background:linear-gradient(to bottom right,#fffdf7,#fff5e9)}
  .page article{white-space:pre-wrap;padding:22px;letter-spacing:.01em;user-select:text}
  .nav{pointer-events:none;position:absolute;inset:0;display:flex;justify-content:space-between;align-items:center}
  .nav > div{pointer-events:auto}
  .round{border-radius:999px;padding:8px 10px;background:transparent}
  .footer{display:flex;gap:10px;align-items:center;margin-top:10px}
  progress{width:100%;height:8px}
  .badge{display:inline-block;border:1px solid rgba(255,255,255,.2);padding:4px 8px;border-radius:999px;font-size:12px;margin-right:6px}
  .linkish{text-decoration:underline;text-underline-offset:3px;cursor:pointer}
  .muted{opacity:.65;font-size:12px}
</style>
</head>
<body data-theme="sepia">
<div class="noise"></div>
<header>
  <div class="bar">
    <div>ğŸ“–</div>
    <div class="title">ã€ä¼šç¤¾ã®ç£¨ãå±‹ã€â€” Stylish eBook</div>
    <div class="spacer"></div>

    <button id="themeBtn" title="ãƒ†ãƒ¼ãƒåˆ‡æ›¿">ğŸ¨ ãƒ†ãƒ¼ãƒ</button>
    <div class="muted" style="display:none" id="fontLabel"></div>
    <button id="smaller" title="å°ã•ã">Aâˆ’</button>
    <span class="muted" id="fontSizeView"></span>
    <button id="bigger" title="å¤§ãã">Aï¼‹</button>

    <label class="muted" style="margin-left:8px">è¡Œé–“ <input id="lh" type="range" min="1.4" max="2.2" step="0.1" value="1.9" /></label>

    <button id="spreadBtn" title="è¦‹é–‹ã">ğŸ— è¦‹é–‹ã</button>
    <button id="tocBtn" title="ç›®æ¬¡">ğŸ“‹ ç›®æ¬¡</button>
    <button id="bmBtn" title="ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯">ğŸ”– ã—ãŠã‚Š</button>
  </div>
  <div style="height:4px;background:rgba(255,255,255,.2);position:relative">
    <div id="progressBar" style="height:4px;background:linear-gradient(90deg,#34d399,#06b6d4);width:0%"></div>
  </div>
</header>

<div id="grid" class="grid">
  <aside id="toc" style="display:none">
    <div class="muted">ç›®æ¬¡</div>
    <ul id="tocList" style="list-style:none;padding-left:0"></ul>
    <div id="bmListWrap" style="margin-top:12px;display:none">
      <div class="muted">ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯</div>
      <div id="bmList"></div>
    </div>
  </aside>

  <div>
    <div class="viewer">
      <div id="pages" class="pages"></div>
      <div class="nav">
        <div><button class="round" id="prev">â†</button></div>
        <div><button class="round" id="next">â†’</button></div>
      </div>
    </div>
    <div class="footer">
      <span class="muted" id="pageInfo"></span>
      <input type="range" id="slider" min="0" max="0" value="0" style="flex:1"/>
      <span class="muted" id="hint" style="white-space:nowrap"></span>
    </div>
  </div>
</div>

<script>
  const state = {
    theme: localStorage.getItem('eb.theme') || 'sepia',
    font: parseInt(localStorage.getItem('eb.font') || '18', 10),
    lh: parseFloat(localStorage.getItem('eb.lh') || '1.9'),
    spread: JSON.parse(localStorage.getItem('eb.spread') || 'true'),
    page: parseInt(localStorage.getItem('eb.page') || '0', 10),
    bm: JSON.parse(localStorage.getItem('eb.bm') || '[]')
  };

  const content = 'ãƒ“ã‚¸ãƒã‚¹å°èª¬ï¼šã€ä¼šç¤¾ã®ç£¨ãå±‹ã€\n\nãƒ—ãƒ­ãƒ­ãƒ¼ã‚°\n\n2025å¹´8æœˆã€åŸ¼ç‰çœŒã®ç‰‡éš…ã€‚ç”°ä¸­è£½ä½œæ‰€ã®ç¤¾é•·ã€ç”°ä¸­å¥å¸ï¼ˆ52æ­³ï¼‰ã®èƒŒä¸­ã¯ã€æ²¹ã¨æ±—ã®åŒ‚ã„ãŒ\næŸ“ã¿ã¤ã„ãŸä½œæ¥­ç€ã®ä¸Šã‹ã‚‰ã§ã‚‚ã‚ã‹ã‚‹ã»ã©ã€é‡ãä¸¸ã¾ã£ã¦ã„ãŸã€‚å…ˆä»£ã§ã‚ã‚‹çˆ¶ã‹ã‚‰ç¶™ã„ã é‡‘å±åŠ å·¥ã®å·¥å ´ã¯ã€èµ¤å­—ã§ã¯ãªã„ã€‚ã—ã‹ã—ã€æˆé•·ã‚‚ã—ã¦ã„ãªã„ã€‚ã¾ã‚‹ã§ç†±å¸¯ã®ç„¡é¢¨åœ°å¸¯ã®ã‚ˆã†ã«ã€ãŸã æš‘ãã€æ¯è‹¦ã—ã„åœæ»æ„ŸãŒå·¥å ´å…¨ä½“ã‚’è¦†ã£ã¦ã„ãŸã€‚\n\nã€Œ10å¹´å¾Œï¼Ÿå†—è«‡ã§ã—ã‚‡ã†ã€‚æ¥æœˆã®è³‡é‡‘ç¹°ã‚Šã§é ­ãŒã„ã£ã±ã„ã§ã™ã‚ˆã€\n\nå–å¼•éŠ€è¡Œã®ç´¹ä»‹ã§ã‚„ã£ã¦ããŸã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆã€ä½è—¤ç”±ç¾ï¼ˆ38æ­³ï¼‰ã«ã€å¥å¸ã¯åãæ¨ã¦ã‚‹ã‚ˆã†ã«è¨€ã£ãŸã€‚ç´°èº«ã®ã‚¹ãƒ¼ãƒ„ã‚’ç€ã“ãªã—ãŸå½¼å¥³ã¯ã€ã„ã‹ã«ã‚‚ã€Œæ¨ªæ–‡å­—ã€ã‚’ä¸¦ã¹ç«‹ã¦ãã†ãªé›°å›²æ°—ã‚’ã¾ã¨ã£ã¦ã„ãŸã€‚ã©ã†ã›ã¾ãŸã€DXã ã®ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã ã®ã€ã†ã¡ã¿ãŸã„ãªç”ºå·¥å ´ã«ã¯ç¸ã®ãªã„è©±ã‚’ã•ã‚Œã‚‹ã®ã ã‚ã†ã€‚\n\nç”±ç¾ã¯å¾®ç¬‘ã¿ã‚’å´©ã•ãšã€æ„å¤–ãªè¨€è‘‰ã‚’å£ã«ã—ãŸã€‚\n\nã€Œç”°ä¸­ç¤¾é•·ã€ç§ã¯ã€ä¼šç¤¾ã®ç£¨ãä¸Šã’ã€ã‚’å°‚é–€ã«ã—ã¦ã„ã¾ã™ã€‚ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãªã‚“ã¦ã€ãƒ¡ãƒƒã‚­ã¿ãŸã„ãªã‚‚ã®ã§ã™ã‹ã‚‰å«Œã„ãªã‚“ã§ã™ã€‚æœ¬è³ªçš„ãªè¼ãã¯ã€ã©ã‚“ãªä¼šç¤¾ã«ã‚‚å¿…ãšã‚ã‚Šã¾ã™ã‹ã‚‰ã€\n\nã€ç£¨ãä¸Šã’ã€ã€‚ãã®è¨€è‘‰ã«ã€è·äººã§ã‚ã‚‹å¥å¸ã®è€³ãŒã‚ãšã‹ã«å‹•ã„ãŸ.\n\nç¬¬ä¸€ç« ï¼šæœªæ¥ã‚’æã‘ãªã„ç”·\n\næœ€åˆã®é¢è«‡ã¯ã€å·¥å ´ã®éš…ã«ã‚ã‚‹å°ã•ãªäº‹å‹™æ‰€ã§è¡Œã‚ã‚ŒãŸã€‚ç”±ç¾ã¯åˆ†åšã„çµŒå–¶è³‡æ–™ã§ã¯ãªãã€ä¸€æšã®ã‚·ãƒ³ãƒ—ãƒ«ãªç´™ã‚’å–ã‚Šå‡ºã—ãŸã€‚\n\nã€Œç¤¾é•·ã€å°‘ã—ã ã‘å·¥å ´ã®ã“ã¨ã¯å¿˜ã‚Œã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿã€\n\nç”±ç¾ã¯ã€å¥å¸ã®äºˆæƒ³ã¨ã¯å…¨ãé•ã†è³ªå•ã‚’å§‹ã‚ãŸã€‚ã€Œã‚‚ã—ã€æ™‚é–“ã¨ãŠé‡‘ã«ä¸€åˆ‡ã®åˆ¶ç´„ãŒãªã‹ã£ãŸã‚‰ã€ã©ã‚“ãªã€å¤¢ã®ä¼‘æš‡ã€ã‚’éã”ã—ãŸã„ã§ã™ã‹ï¼Ÿã€\n\nã€Œä¼‘æš‡â€¦ï¼Ÿã€å¥å¸ã¯é¢é£Ÿã‚‰ã£ãŸã€‚ã‚‚ã†ä½•å¹´ã‚‚ã€ã¾ã¨ã‚‚ãªä¼‘ã¿ãªã©å–ã£ã¦ã„ãªã„ã€‚ã€Œâ€¦ãã†ã ãªã€‚åŒ—æµ·é“ã§ã€ãƒ•ãƒ©ã‚¤ãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°ã§ã‚‚ã—ã¦ã¿ãŸã„ã‹ãªã€‚è¦ªçˆ¶ã¨è¡Œã£ãŸãã‚Šã ã€\n\nã€Œç´ æ•µãªä¼‘æš‡ã§ã™ã­ã€‚ã§ã¯ã€ã€å®Œç’§ãªä¸€æ—¥ã€ã¯ã©ã‚“ãªæ—¥ã§ã™ã‹ï¼Ÿã€\n\nå¥å¸ã®è„³è£ã«æµ®ã‹ã‚“ã ã®ã¯ã€è¤‡é›‘ãªéƒ¨å“ã‚’è‡ªåˆ†ã®æ‰‹ã§å®Œç’§ã«ä»•ä¸Šã’ãŸæ™‚ã®é”æˆæ„Ÿã€è‹¥æ‰‹ã«æŠ€è¡“ã‚’æ•™ãˆã¦ã„ã‚‹æ™‚ã®å……å®Ÿæ„Ÿã€ãã—ã¦ã€åŸƒã£ã½ã„äº‹å‹™æ‰€ã§ã¯ãªãã€å¦»ã®å¾…ã¤è‡ªå®…ã§æ¸©ã‹ã„å¤•é£Ÿã‚’ã¨ã‚‹ã€ã•ã•ã‚„ã‹ãªæƒ…æ™¯ã ã£ãŸã€‚\n\nã½ã¤ã‚Šã½ã¤ã‚Šã¨èªã‚‹å¥å¸ã®è©±ã‚’ã€ç”±ç¾ã¯ç†±å¿ƒã«ãƒ¡ãƒ¢ã—ã¦ã„ã‚‹ã€‚äº‹æ¥­è¨ˆç”»ã‚‚SWOTåˆ†æã‚‚å‡ºã¦ã“ãªã„å¥‡å¦™ãªã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°ã«ã€å¥å¸ã¯æˆ¸æƒ‘ã„ãªãŒã‚‰ã‚‚ã€å°‘ã—ãšã¤å¿ƒãŒã»ãã‚Œã¦ã„ãã®ã‚’æ„Ÿã˜ã¦ã„ãŸã€‚\n\nã€Œã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€ç”±ç¾ã¯é¡”ã‚’ä¸Šã’ãŸã€‚ã€Œç¤¾é•·ãŒåŒ—æµ·é“ã§ä¸€é€±é–“é‡£ã‚Šã‚’ã™ã‚‹ãŸã‚ã«ã€ã“ã®å·¥å ´ã¯ã©ã†ãªã£ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿæ¯æ—¥ã€å¥¥æ§˜ã¨å¤•é£Ÿã‚’ã¨ã‚‹ãŸã‚ã«ã¯ã€ä½•ãŒå¤‰ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿã€\n\nãƒãƒƒã¨ã•ã›ã‚‰ã‚ŒãŸã€‚ç›®çš„ã¯ã€Œå£²ä¸Šã€‡%ã‚¢ãƒƒãƒ—ã€ã§ã¯ãªã„ã€‚ã€Œè‡ªåˆ†ãŒé‡£ã‚Šã«è¡ŒããŸã‚ã€ã€‚ãã®æ–¹ãŒã€ã‚ˆã»ã©å…·ä½“çš„ã§ã€åˆ‡å®Ÿã ã£ãŸã€‚ä¼šç¤¾ã®æœªæ¥ã¨ã€è‡ªåˆ†ã®äººç”ŸãŒåˆã‚ã¦ç¹‹ãŒã£ãŸæ°—ãŒã—ãŸã€‚\n\nç¬¬äºŒç« ï¼šæœ€åˆã®ã²ã¨ç£¨ã\n\nã€Œã¾ãšã€ã“ã“ã‹ã‚‰ç£¨ãã¾ã—ã‚‡ã†ã€\n\nç”±ç¾ãŒæ¬¡ã«ææ¡ˆã—ãŸã®ã¯ã€ã“ã‚Œã¾ãŸæ„å¤–ãªã“ã¨ã ã£ãŸã€‚ã€Œå¥åº·çµŒå–¶å„ªè‰¯æ³•äººã€ã®ãƒ‘ãƒ³ãƒ•ãƒ¬ãƒƒãƒˆã‚’è¦‹ã›ãªãŒã‚‰ã€å½¼å¥³ã¯è¨€ã£ãŸã€‚\n\nã€Œç¤¾é•·ã‚‚å¾“æ¥­å“¡ã•ã‚“ã‚‚ã€çš†ã•ã‚“å°‘ã—ãŠç–²ã‚Œã®é¡”ã‚’ã—ã¦ã„ã¾ã™ã€‚è‰¯ã„ä»•äº‹ã¯ã€å¥åº·ãªå¿ƒã¨ä½“ã‹ã‚‰ã§ã™ã€‚è©¦ã—ã«ã€ã€OFFICE DE YASAIã€ã¿ãŸã„ãªè¨­ç½®å‹ã®ç¤¾é£Ÿã‚µãƒ¼ãƒ“ã‚¹ã‚’å°å…¥ã—ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿã€\n\nã€Œé‡èœï¼Ÿã†ã¡ã¯ITä¼æ¥­ã˜ã‚ƒãªã„ã‚“ã ãã€å¥å¸ã¯çœ‰ã‚’ã²ãã‚ãŸã€‚\n\nã—ã‹ã—ã€ã€Œç¤¾é•·ãŒé‡£ã‚Šã«è¡ŒããŸã‚ã®ç¬¬ä¸€æ­©ã§ã™ã€ã¨ã„ã†ç”±ç¾ã®è¨€è‘‰ã«ã€ãªãœã‹èª¬å¾—ã•ã‚Œã¦ã—ã¾ã£ãŸã€‚\n\nçµæœã¯é©šãã ã£ãŸã€‚ä¼‘æ†©å®¤ã«ç½®ã‹ã‚ŒãŸå†·è”µåº«ã®ã‚µãƒ©ãƒ€ã‚„ç·èœã¯ã€ã‚ã£ã¨ã„ã†é–“ã«ãªããªã£ãŸã€‚ç‰¹ã«ã€ã‚³ãƒ³ãƒ“ãƒ‹å¼å½“ã°ã‹ã‚Šã ã£ãŸè‹¥ã„å¾“æ¥­å“¡ãŸã¡ã®é£Ÿã„ã¤ããŒè‰¯ã‹ã£ãŸã€‚ã€Œç¤¾é•·ã€ã“ã‚Œã€ã„ã„ã£ã™ã­ã€ã€‚ãã‚“ãªå£°ãŒã€å¥å¸ã®è€³ã«ç›´æ¥å±Šãã‚ˆã†ã«ãªã£ãŸã€‚å·¥å ´ã®ç©ºæ°—ãŒã€ã»ã‚“ã®å°‘ã—ã ã‘è»½ããªã£ãŸã€‚\n\nã‚ã‚‹æ—¥ã€ç”±ç¾ã¯ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ã‚’é–‹ãã€è‡ªä½œã®ãƒ„ãƒ¼ãƒ«ã‚’è¦‹ã›ãŸã€‚ãã‚Œã¯ã€ä¼æ¥­ã®ç£¨ãä¸Šã’ãƒ—ãƒ©ãƒ³ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã€ã¨åä»˜ã‘ã‚‰ã‚ŒãŸã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã ã£ãŸã€‚\n\nã€Œç¤¾é•·ã€ä»Šã®å–ã‚Šçµ„ã¿ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€\n\nç”±ç¾ãŒã€Œå¥åº·ã¨åƒããŒã„ã€ã®ã‚«ãƒ†ã‚´ãƒªãƒ¼ã«ã‚ã‚‹ã€Œé£Ÿç”Ÿæ´»ã‚µãƒãƒ¼ãƒˆã®å°å…¥ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã®ã‚°ãƒ©ãƒ•ãŒä¸€ã¤ã®æ–¹å‘ã«å°‘ã—ã ã‘ä¼¸ã³ãŸã€‚ã—ã‹ã—ã€ä»–ã®é …ç›®ã¯ä½ã„ã¾ã¾ã ã€‚ç‰¹ã«ã€Œã‚¹ã‚­ãƒ«ã¨ã‚­ãƒ£ãƒªã‚¢ã€ã®é …ç›®ãŒè‘—ã—ãä½ã„ã€‚\n\nã€Œãã†ã„ãˆã°â€¦ã€å¥å¸ã¯å£ã‚’é–‹ã„ãŸã€‚ã€Œãƒ™ãƒ†ãƒ©ãƒ³ã®éˆ´æœ¨ã•ã‚“ã¯ã€ã‚‚ã†ã™ãå®šå¹´ã ãŒã€å½¼ã®æŒã£ã¦ã„ã‚‹æŠ€è¡“ã¯èª°ã‚‚å¼•ãç¶™ã’ã¦ã„ãªã„ã€‚å½¼ãŒã„ãªããªã£ãŸã‚‰ã€ã†ã¡ã®å“è³ªã¯ã‚¬ã‚¿è½ã¡ã â€¦ã€\n\nãã‚Œã¯ã€ãšã£ã¨è¦‹ã¦è¦‹ã¬ãµã‚Šã‚’ã—ã¦ããŸã€ã“ã®å·¥å ´ã®æœ€å¤§ã®èª²é¡Œã ã£ãŸã€‚\n\nç¬¬ä¸‰ç« ï¼šè¼ãå§‹ã‚ã‚‹ç¾å ´\n\nç”±ç¾ã®ææ¡ˆã¯ã‚·ãƒ³ãƒ—ãƒ«ã ã£ãŸã€‚\n\nã€Œæ¯é€±é‡‘æ›œã®çµ‚æ¥­å‰ã«30åˆ†ã ã‘ã€ã€éˆ´æœ¨å¡¾ã€ã‚’é–‹ãã¾ã—ã‚‡ã†ã€‚éˆ´æœ¨ã•ã‚“ãŒå…ˆç”Ÿã«ãªã£ã¦ã€è‹¥æ‰‹ã«ä¸€ã¤ã ã‘æŠ€è¡“ã‚’æ•™ãˆã‚‹ã‚“ã§ã™ã€‚ãã‚ŒãŒã€ç£¨ãä¸Šã’ã®ç¬¬äºŒæ­©ã§ã™ã€\n\nã€Œéˆ´æœ¨å¡¾ã€ã¯ã™ãã«å§‹ã¾ã£ãŸã€‚æœ€åˆã¯æˆ¸æƒ‘ã£ã¦ã„ãŸéˆ´æœ¨ã‚‚ã€ç†±å¿ƒã«è³ªå•ã™ã‚‹è‹¥æ‰‹ãŸã¡ã‚’å‰ã«ã€æ¬¡ç¬¬ã«é¡”ãŒã»ã“ã‚ã‚“ã§ã„ã£ãŸã€‚ãã‚Œã¯ã€ã“ã‚Œã¾ã§å¥å¸ã—ã‹æ‹…ã£ã¦ã“ãªã‹ã£ãŸã€Œäººæè‚²æˆã€ã¨ã„ã†å½¹å‰²ãŒã€ç¾å ´ã«ç”Ÿã¾ã‚ŒãŸç¬é–“ã ã£ãŸã€‚\n\nåŒæ™‚ã«ã€ç”±ç¾ã¯å¥å¸ã«ã€Œã‚·ãƒ³ãƒ—ãƒ«ãªçµ±åˆå ±å‘Šæ›¸ã€ã®ä½œæˆã‚’å‹§ã‚ãŸã€‚å£²ä¸Šã‚„åˆ©ç›Šã ã‘ã§ãªãã€ã€Œå¥åº·çµŒå–¶ã®å–ã‚Šçµ„ã¿ã€ã‚„ã€Œéˆ´æœ¨å¡¾ã«ã‚ˆã‚‹æŠ€è¡“ä¼æ‰¿ã€ã¨ã„ã£ãŸã€ã“ã®æ•°ãƒ¶æœˆã®ã€ç£¨ãä¸Šã’ã€ã®æˆæœã‚’A4ä¸€æšã«ã¾ã¨ã‚ã‚‹ã®ã ã€‚\n\nã€Œã“ã‚Œã¯ã€éŠ€è¡Œã‚„å–å¼•å…ˆã«è¦‹ã›ã‚‹ãŸã‚ã ã‘ã˜ã‚ƒã‚ã‚Šã¾ã›ã‚“ã€‚å¾“æ¥­å“¡ã®çš†ã•ã‚“ã¨ã€ãã—ã¦æœªæ¥ã®å¾Œç¶™è€…ã«è¦‹ã›ã‚‹ãŸã‚ã®ã€ã€ä¼šç¤¾ã®ä¾¡å€¤ã®è¨¼æ˜æ›¸ã€ã§ã™ã€\n\nå¥å¸ã¯ã€åˆã‚ã¦å®¢è¦³çš„ãªè¦–ç‚¹ã§è‡ªåˆ†ã®ä¼šç¤¾ã‚’è¦‹ã¤ã‚ãŸã€‚æ•°å­—ã ã‘ã®ä¼šç¤¾ã§ã¯ãªã„ã€‚äººãŒè‚²ã¡ã€å¥åº·ã‚’æ°—é£ã†æ–‡åŒ–ãŒç”Ÿã¾ã‚Œå§‹ã‚ã¦ã„ã‚‹ã€‚æ‚ªããªã„ã€ã¨ç´ ç›´ã«æ€ãˆãŸã€‚\n\nãã®çŸ¢å…ˆã€æ–°è¦ã®å–å¼•å…ˆã‹ã‚‰ã€æ¥µã‚ã¦ç²¾åº¦ã®é«˜ã„ã€é›£ã—ã„åŠ å·¥ä¾é ¼ãŒèˆã„è¾¼ã‚“ã ã€‚ä»¥å‰ãªã‚‰ã€å¥å¸ãŒä¸€äººã§å¾¹å¤œã—ã¦ä»•ä¸Šã’ã‚‹ã‚ˆã†ãªä»•äº‹ã ã€‚\n\nã ãŒã€å½¼ã¯é•ã£ãŸã€‚éˆ´æœ¨ã¨ã€ã€Œéˆ´æœ¨å¡¾ã€ã®ä¸€æœŸç”Ÿã§ã‚ã‚‹è‹¥æ‰‹äºŒäººã‚’å‘¼ã³ã€è¨€ã£ãŸã€‚\n\nã€Œã“ã®ä»•äº‹ã€ãŠå‰ãŸã¡ã«ä»»ã›ã‚‹ã€‚ä¿ºã¯ç›£ç£ã«å¾¹ã™ã‚‹ã‹ã‚‰ã€ã‚„ã£ã¦ã¿ã‚ã€\n\nè‹¥è€…ãŸã¡ã®ç›®ãŒè¼ã„ãŸã€‚å¥å¸ã¯æ‰‹ã‚’å‡ºã™ã®ã‚’ãã£ã¨ã“ã‚‰ãˆã€å½¼ã‚‰ã®ä½œæ¥­ã‚’è¦‹å®ˆã£ãŸã€‚å¤œ6æ™‚ã€å®šæ™‚ã®ãƒãƒ£ã‚¤ãƒ ãŒé³´ã‚‹ã€‚å¥å¸ã¯ã‚¿ã‚¤ãƒ ã‚«ãƒ¼ãƒ‰ã‚’æŠ¼ã—ãŸã€‚ã¾ã å·¥å ´ã§ã¯ä½œæ¥­ãŒç¶šã„ã¦ã„ãŸãŒã€å½¼ã®å¿ƒã¯ä¸æ€è­°ãªã»ã©ç©ã‚„ã‹ã ã£ãŸã€‚\n\nã‚¨ãƒ”ãƒ­ãƒ¼ã‚°\n\nä¸€å¹´å¾Œã€‚ç”°ä¸­è£½ä½œæ‰€ã®äº‹å‹™æ‰€ã«ã¯ã€ã€Œå¥åº·çµŒå–¶å„ªè‰¯æ³•äºº2026ã€ã®èªå®šè¨¼ãŒèª‡ã‚‰ã—ã’ã«é£¾ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ã‚ã®é›£ã—ã„ä»•äº‹ã‚’è¦‹äº‹ã«ã‚„ã‚Šé‚ã’ãŸè‹¥è€…ãŸã¡ã¯ã€ä»Šã‚„å·¥å ´ã®ä¸­å¿ƒãƒ¡ãƒ³ãƒãƒ¼ã ã€‚éˆ´æœ¨ã¯å®šå¹´ã‚’å»¶é•·ã—ã€æ¥½ã—ãã†ã«æŠ€è¡“æŒ‡å°ã‚’ç¶šã‘ã¦ã„ã‚‹ã€‚\n\nå¥å¸ã¯ã€ä¸€é€±é–“ã®ä¼‘æš‡ã‚’å–ã‚Šã€å¿µé¡˜ã ã£ãŸåŒ—æµ·é“ã®æ¸“æµã§é‡£ã‚Šã‚’ã—ã¦ã„ãŸã€‚ç³¸ã‚’å‚ã‚‰ã—ãªãŒã‚‰ã€å½¼ã¯ç”±ç¾ã®è¨€è‘‰ã‚’æ€ã„å‡ºã—ã¦ã„ãŸã€‚\n\nã€æœ¬è³ªçš„ãªè¼ãã¯ã€ã©ã‚“ãªä¼šç¤¾ã«ã‚‚å¿…ãšã‚ã‚Šã¾ã™ã€\n\nè‡ªåˆ†ã®ä¼šç¤¾ã«ã‚ã£ãŸè¼ãã€‚ãã‚Œã¯ã€é«˜ã„æŠ€è¡“åŠ›ã ã‘ã§ã¯ãªã‹ã£ãŸã€‚äººã‚’æ€ã„ã‚„ã‚‹å¿ƒã€æˆé•·ã—ãŸã„ã¨é¡˜ã†è‹¥è€…ã®ç†±æ„ã€ãã—ã¦ã€ãã‚Œã‚‰ã‚’ç¹‹ãåˆã‚ã›ã‚‹ã€Œä»•çµ„ã¿ã€ã ã£ãŸã€‚ç”±ç¾ã¯ã€ãã‚Œã‚‰ã‚’è¦†ã£ã¦ã„ãŸåŸƒã‚’æ‰•ã„ã€å…‰ã‚’å½“ã¦ã€ç£¨ãä¸Šã’ã¦ãã‚ŒãŸã ã‘ãªã®ã ã€‚\n\nå·é¢ãŒã‚­ãƒ©ã‚­ãƒ©ã¨è¼ã„ã¦ã„ã‚‹ã€‚ã¾ã‚‹ã§ã€ç£¨ãä¸Šã’ã‚‰ã‚ŒãŸè‡ªåˆ†ã®ä¼šç¤¾ã®ã‚ˆã†ã«ã€‚å¥å¸ã¯ã€æº€è¶³ã’ã«å¾®ç¬‘ã‚“ã ã€‚\n\nï¼ˆäº†ï¼‰';

  const pagesEl = document.getElementById('pages');
  const grid = document.getElementById('grid');
  const toc = document.getElementById('toc');
  const tocList = document.getElementById('tocList');
  const bmListWrap = document.getElementById('bmListWrap');
  const bmList = document.getElementById('bmList');
  const pageInfo = document.getElementById('pageInfo');
  const slider = document.getElementById('slider');
  const progressBar = document.getElementById('progressBar');
  const fontSizeView = document.getElementById('fontSizeView');

  function save(){
    localStorage.setItem('eb.theme', state.theme);
    localStorage.setItem('eb.font', String(state.font));
    localStorage.setItem('eb.lh', String(state.lh));
    localStorage.setItem('eb.spread', JSON.stringify(state.spread));
    localStorage.setItem('eb.page', String(state.page));
    localStorage.setItem('eb.bm', JSON.stringify(state.bm));
  }

  function applyTheme(){ document.body.setAttribute('data-theme', state.theme); }
  function setFont(delta){ state.font = Math.max(12, Math.min(28, state.font + delta)); renderPages(true); }
  function setLH(val){ state.lh = Math.max(1.4, Math.min(2.2, val)); renderPages(true); }
  function toggleSpread(){ state.spread = !state.spread; renderPages(true); }
  function toggleToc(){ toc.style.display = toc.style.display === 'none' ? 'block' : 'none'; grid.classList.toggle('toc-open'); }
  function next(){
    const step = state.spread ? 2 : 1;
    goTo(state.page + step);
  }
  function prev(){
    const step = state.spread ? 2 : 1;
    goTo(state.page - step);
  }
  function goTo(p){
    state.page = Math.max(0, Math.min(p, window.__pages.length-1));
    updateUI();
  }
  function toggleBookmark(){
    const key = state.spread ? Math.floor(state.page/2)*2 : state.page;
    const idx = state.bm.indexOf(key);
    if(idx>=0) state.bm.splice(idx,1);
    else state.bm.push(key);
    updateBM();
    save();
  }
  function updateBM(){
    bmListWrap.style.display = state.bm.length ? 'block' : 'none';
    bmList.innerHTML = '';
    state.bm.sort((a,b)=>a-b).forEach(p=>{ 
      const b = document.createElement('button');
      b.className = 'badge';
      b.textContent = 'p.'+(p+1);
      b.onclick = ()=> goTo(p);
      bmList.appendChild(b);
    });
  }

  // TOC detection
  function buildTOC(){
    tocList.innerHTML = '';
    const lines = content.split(/\n+/);
    let idx = 0;
    lines.forEach(line=>{
      if(/^ç¬¬[ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å0-9]+ç« /.test(line) || /ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°|ã‚¨ãƒ”ãƒ­ãƒ¼ã‚°/.test(line)){
        const li = document.createElement('li');
        const btn = document.createElement('button');
        btn.textContent = line.trim();
        btn.style.cssText = 'width:100%;text-align:left;padding:6px 8px;border-radius:10px;border:1px solid rgba(255,255,255,.2);margin:4px 0;cursor:pointer;background:transparent';
        btn.onmouseover = ()=> btn.style.background='rgba(255,255,255,.1)';
        btn.onmouseout = ()=> btn.style.background='transparent';
        btn.onclick = ()=>{ 
          const p = Math.floor(idx / (window.__cpp||800));
          state.page = state.spread ? p - (p%2) : p;
          updateUI();
        };
        li.appendChild(btn);
        tocList.appendChild(li);
      }
      idx += line.length + 1;
    });
  }

  function estimateCPP(){
    const viewer = pagesEl.parentElement;
    const styles = getComputedStyle(viewer);
    const padX = 32; // approx
    const padY = 32;
    const width = viewer.clientWidth - padX;
    const height = viewer.clientHeight - padY;
    const columns = (state.spread && width >= 900) ? 2 : 1;
    const pageWidth = width / columns;
    const linePx = state.font * state.lh;
    const linesPerPage = Math.max(8, Math.floor(height / linePx));
    const charsPerLine = Math.max(12, Math.floor(pageWidth / (state.font * 0.95)));
    const cpp = Math.max(200, Math.floor(linesPerPage * charsPerLine));
    return cpp;
  }

  function renderPages(resetPage){
    applyTheme();
    pagesEl.className = 'pages' + (state.spread ? ' spread' : '');
    pagesEl.style.setProperty('--font', state.font + 'px');
    pagesEl.style.setProperty('--lh', state.lh);
    fontSizeView.textContent = state.font + 'px';

    // paginate
    const cpp = estimateCPP();
    window.__cpp = cpp;
    const chunks = [];
    for(let i=0;i<content.length;i+=cpp) chunks.push(content.slice(i,i+cpp));
    window.__pages = chunks;
    if(resetPage) state.page = Math.min(state.page, chunks.length-1);

    updateUI();
    buildTOC();
    updateBM();
  }

  function updateUI(){
    const chunks = window.__pages || [content];
    pagesEl.innerHTML = '';
    if(state.spread){
      const spreadIndex = Math.floor(state.page/2);
      const left = chunks[spreadIndex*2] || '';
      const right = chunks[spreadIndex*2+1] || '';
      pagesEl.innerHTML = `
        <div class="page"><article style="font-size:${state.font}px; line-height:${state.lh}">${escapeHTML(left)}</article></div>
        <div class="page"><article style="font-size:${state.font}px; line-height:${state.lh}">${escapeHTML(right)}</article></div>
      `;
      slider.max = Math.max(0, Math.ceil(chunks.length/2)-1);
      slider.value = spreadIndex;
      pageInfo.textContent = `ãƒšãƒ¼ã‚¸ ${spreadIndex+1} / ${Math.ceil(chunks.length/2)}`;
      const progress = ((spreadIndex+1)/Math.max(1,Math.ceil(chunks.length/2)))*100;
      progressBar.style.width = progress.toFixed(2)+'%';
    } else {
      const cur = chunks[state.page] || '';
      pagesEl.innerHTML = `<div class="page"><article style="font-size:${state.font}px; line-height:${state.lh}">${escapeHTML(cur)}</article></div>`;
      slider.max = Math.max(0, chunks.length-1);
      slider.value = state.page;
      pageInfo.textContent = `ãƒšãƒ¼ã‚¸ ${state.page+1} / ${chunks.length}`;
      const progress = ((state.page+1)/Math.max(1,chunks.length))*100;
      progressBar.style.width = progress.toFixed(2)+'%';
    }
    save();
  }

  function escapeHTML(s){
    return s.replace(/[&<>'"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','\'':'&#39;','"':'&quot;'})[c]);
  }

  // events
  document.getElementById('themeBtn').onclick = ()=>{
    const order = ['sepia','light','dark'];
    const i = order.indexOf(state.theme);
    state.theme = order[(i+1)%order.length];
    applyTheme(); save();
  };
  document.getElementById('smaller').onclick = ()=> setFont(-1);
  document.getElementById('bigger').onclick = ()=> setFont(1);
  document.getElementById('lh').oninput = (e)=> setLH(parseFloat(e.target.value));
  document.getElementById('spreadBtn').onclick = ()=> toggleSpread();
  document.getElementById('tocBtn').onclick = ()=> toggleToc();
  document.getElementById('bmBtn').onclick = ()=> toggleBookmark();
  document.getElementById('prev').onclick = ()=> prev();
  document.getElementById('next').onclick = ()=> next();
  slider.oninput = (e)=> {
    const v = parseInt(e.target.value, 10);
    if(state.spread) state.page = v*2; else state.page = v;
    updateUI();
  };

  window.addEventListener('resize', ()=> renderPages(false));
  window.addEventListener('keydown', (e)=>{
    if(e.key === 'ArrowRight') next();
    if(e.key === 'ArrowLeft') prev();
    if(e.key === ' ') { e.preventDefault(); toggleSpread(); }
  });

  // init
  applyTheme();
  document.body.setAttribute('data-theme', state.theme);
  document.getElementById('lh').value = state.lh;
  renderPages(false);
</script>
</body>
</html>
